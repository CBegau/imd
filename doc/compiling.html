---
title: Compiling
---

{% include imdhead.html %}

<h1>Compiling</h1>

<p>
IMD is compiled with GNU make, which we call gmake in the
following. Note that on some systems, GNU make is called make.
Most other implementations of make won't work.</p>

<pre>
   gmake [FLAGS="some flags"] [IMDSYS="some system"] imd-target
</pre>

<p>
The compiler and compilation flags are determined according to the 
<a href="compiling.html#imdsys">IMDSYS variable</a>, which must be 
set either as an environment variable, or be passed on the command 
line as above. In previous versions of IMD, the HOSTTYPE environment 
variable was used for this purpose, but this turned out to be too 
inflexible. Especially for the IA32 architechture, there are too 
many processor types requiring their own optimization flags, which 
moreover depend on the choice of compiler (gcc2, gcc3, icc,...).
It therefore seemed necessary to introduce a new, IMD-specific variable
IMDSYS, which now determines a combination of system type and compiler,
together with all associated compile and link flags. Further compile
or ling flags, in addition to those determined by the IMDSYS variable, 
can be passed on the command line with the help of the FLAGS variable.</p>

<p>
After compiling, the IMD executable is moved to the directory 
$HOME/bin/$HOSTTYPE, which must exist, and which should be in the 
search path. The location where executables are put can be customized 
in the Makefile. </p>

<p>
<tt>imd-target</tt> consists of several components and has the
following structure:</p>

<pre>
   imd[_parallelization]_ensemble[_ensemble]...[_2d][_option][_option]...
</pre>

<p>
Most features of IMD must be activated with the corresponding 
compilation option in the make target. In particular, you need to 
enable the integrator (ensemble) you want to use, and possibly support 
for different interactions, if you don't want to use tabulated 
pair potentials. Most options can coexist with each other. 
In particular, it is possible to compile support for several
integrators. The active one is selected with a <a href="params.html">
parameter</a> read from the <a href="paramfile.html">parameter file</a>. 
</p>

<p>
There are a few compilation options which cannot coexist with each
other. In particular, IMD must be compiled for a fixed dimension
(default is 3d, option _2d switches to 2d), and there are some
<a href="potentials.html">restrictions</a> on the types of interaction 
which can be combined.</p>

<h2>Compilation Options</h2>

<p>
Most compilation options are described together with the simulation
features they enable. For details, see the corresponding chapters.
Here, we only list some general options.</p>

<h3>Parallelization options</h3>

<p>  
IMD can be compiled with the following parallelization options.
If none of these is specified, a serial executable is compiled.
</p>

<table>
<tr><td>mpi        </td> <td>parallelization with MPI            </td></tr>
<tr><td>omp        </td> <td>parallelization with OpenMP         </td></tr>
<tr><td>ompi&nbsp; </td> <td>parallelization with MPI and OpenMP </td></tr>
</table>

<h3>Vectorization options</h3>

<p>  
IMD can be compiled with the following vectorization options.
</p>

<table>
<tr><td>vec        </td> <td>compiled for vector machines. Options are
    given in the <a href="params.html#vec">parameter file </td></tr>
<tr><td>cbe        </td> <td>compiled for cell processor support. Options are
    given in the <a href="params.html#cbe">parameter file</td></tr>
</table>

<h3>Programming options</h3>

<table>
<tr><td>2d           </td><td>2d simulation</td></tr>
<tr><td>single       </td><td>compile with single precision (not recommended)</td></tr>
<tr><td>mono         </td><td>compile for sample with one atom type (faster)</td></tr>
<tr><td>binary       </td><td>compile for binary sample (faster)</td></tr>
<tr><td>hpo          </td><td>enable high precision output</td></tr>
<tr><td>debug        </td><td>compile with debug support</td></tr>
<tr><td>prof         </td><td>compile with profiling support</td></tr>
<tr><td>timing&nbsp; </td><td>compile with extra timers</td></tr>
<tr><td>sr           </td><td>use sendrecv in MPI version</td></tr>
</table>

<h2><a id="imdsys" name="imdsys">
Supported values of the IMDSYS variable</a></h2>

<p>
Currently, the following values of the IMDSYS variable are supported:</p>

<table>
<tr><td>AthlonMP-icc  </td><td> Athlon MP or XP, icc                 </td></tr>
<tr><td>AthlonMP-gcc3 </td><td> Athlon MP or XP, gcc3                </td></tr>
<tr><td>P4-icc        </td><td> Pentium 4 or Xeon, icc               </td></tr>
<tr><td>P4-gcc3       </td><td> Pentium 4 or Xeon, gcc3              </td></tr>
<tr><td>P3-icc        </td><td> Pentium II/III, icc                  </td></tr>
<tr><td>P3-gcc3       </td><td> Pentium II/III, gcc3                 </td></tr>
<tr><td>ia32-gcc2     </td><td> generic IA32, gcc2 (very slow)       </td></tr>
<tr><td>ia64-ecc      </td><td> Intel Itanium 2, ecc                 </td></tr>
<tr><td>alpha-cc      </td><td> Alpha EV56, cc                       </td></tr>
<tr><td>alpha-gcc2    </td><td> Alpha EV56, gcc2 (slow)              </td></tr>
<tr><td>irix-cc       </td><td> Irix, mips3, cc                      </td></tr>
<tr><td>irix-gcc2     </td><td> Irix, mips3, gcc2 (slow)             </td></tr>
<tr><td>USparc3-cc    </td><td> UltraSparc3, cc                      </td></tr>
<tr><td>sparc-gcc2    </td><td> generic sparc, gcc2 (slow)           </td></tr>
<tr><td>T3E-cc        </td><td> Cray T3E, cc                         </td></tr>
<tr><td>sr8k-cc       </td><td> HITACHI SR8000, cc                   </td></tr>
<tr><td>sr8k-xcc      </td><td> xcc cross compiler for HITACHI SR8000</td></tr>
<tr><td>Power4-cc     </td><td> IBM Power4, cc </td></tr>
</table>

<p>
The GCC 2.x compilers should usually be avoided. Especially on the IA32
architecture, they produce very slow code. GCC 3.2 or the Intel compiler
icc are much better choices. </p>

<p>
Support for further values of IMDSYS is easily added. The Makefile
contains a detailed description of how the compile and link flags
are determined from a number of Makefile variables, which must be
set for each supported value of IMDSYS. There is a template from
which one can start. </p>

{% include imdfoot.html %}
