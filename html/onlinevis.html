
<!--#include virtual="imdhead.html" -->

<h1>Online Visualization</h1>

<p>
IMD can communicate with external programs via a bi-directional
socket connection. This mechanism allows for online visualization
and steering of the simulation. Socket communication must be
enabled with the compilation option <b>sock</b>. If enabled,
IMD polls the socket connection for new requests every
<tt>socket_int</tt> time steps. If <tt>socket_int &gt; 0</tt>, 
the socket connection is created at the simulation start.
The simulation will not proceed before the connection is established.
If <tt>socket_int = 0</tt>, no socket connection is created.
In either case, it is not possible to connect or reconnect at
a later stage of the simulation.</p>

<p>
If the parameter <tt>loop</tt> is set to <tt>1</tt>, the entire
simulation is repeated again and again. This allows to restart
the simulation, by jumping to the simulation end, and then
repeating it.</p>

<h2>Socket communication</h2>

<p>
In the socket communication, IMD can play either the server
part or the client part. This is chosen by the parameter
<tt>socket_mode</tt>, whose value is either <tt>server</tt>
or <tt>client</tt>. Depending on this mode, different other
parameters have to be specified. Once the connection is
established, the communication does not depend on the
socket mode.</p>

<h3>Server mode</h3>

<p>
In server mode, IMD opens a server socket on the local port 
<tt>server_port</tt>, and waits for the client to connect.
The first connection attempt is accepted. Under MPI, the 
<tt>server_port</tt> is on the machine with the rank 0 process. 
In server mode, the visualization must be able to contact 
the machine IMD runs on. In a cluster environment, 
where the cluster nodes often have private IP addresses, 
this may not be possible. In this case, IMD should rather
run in client mode.</p>

<h3>Client mode</h3>

<p>
In client mode, IMD tries to connect to a server socket at
port <tt>server_port</tt> on the machine specified by the
parameter <tt>display_host</tt>. This is the machine the
visualization runs on. By default, the connect call choses
some local port on the simulation machine at which IMD can
be contacted. In the presence of a firewall, it may be
necessary to specify which local port shall be used. This
can be done with the parameter <tt>client_port</tt>.
If <tt>client_port = 0</tt> (default), the system choses a 
port itself. If both IMD and visualization run on the same 
machine, the two ports <tt>server_port</tt> and <tt>client_port</tt>
must be different, but in that case there is no point
prescribing a <tt>client_port</tt>. If IMD and visualization
run on different machines, the two ports may be equal.
Client mode should work also if the simulation machine has
a private IP address, as connections from a private to a
public IP address should be handled by Network Address
Translation (NAT) at the gateway.</p>

<h2>Supported online visualization programs</h2>

<p>
The currently supported online visualization program is the 
COVER renderer from 
<a href="http://www.hlrs.de/organization/vis/covise/">COVISE</a>, 
which has been equipped with a plugin (written by
<a href="http://www.hlrs.de/organization/vis/people/schulze/">
J&uuml;rgen Schulze-D&ouml;bold</a>) implementing the 
communication protocol with IMD.</p>

<!--#include virtual="imdfoot.html" -->
