<HTML>
<HEAD>
   <TITLE>IMD Ensembles</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<H1>IMD Ensembles</H1>

IMD supports several different MD integrators. Many of them correspont
to thermodynamic ensembles. Integrators are selected via the 
<TT>ensemble</TT> parameter.

<UL>

<P><LI><B> nve </B><P>
Constant volume, constant energy ensemble. This is the most reliable
integrator, and thus the main work horse. No particular parameters
are needed, except perhaps the initial temperature starttemp, if not 
all atoms have their velocities given in the configuration file.

<P><LI><B> nvt </B><P>
Constant volume, constant temperature ensemble, with 
Nos&eacute;-Hoover thermostat (more precisely, this is an 
ensemble with external temperature control - the temperature
can actually vary during the simulation). The imposed temperature
varies linearly from starttemp to endtemp (parameters).
A further required parameter is the time constant of the
temperature control, tau_eta. Alternatively, the parameter
isq_tau_eta can be specified, which is equal to the inverse
square of tau_eta. isq_tau_eta can be zero, which means constant
energy simulation (nve).

<P><LI><B> and </B><P>
Constant volume, constant temperature ensemble, with Anderson
thermostat. Similar to nvt, but with a different temperature
control mechanism. The temperature is corrected every tempintv
steps (parameter). tau_eta is not needed here.

<P><LI><B> npt_iso </B><P>
Constant pressure, constant temperature ensemble, with isotropic 
volume scaling. Nos&eacute;-Hoover type thermostat and volume control 
are employed. Temperature control is as in nvt, with the same parameters.
The pressure varies linearly from pressure_start to pressure_end
(parameters). A time constant for the pressure control, tau_xi,
or its inverse square, isq_tau_xi, is required as a parameter.
If isq_tau_xi is zero, the volume remains constant. The cell
subdivision includes a rescaling tolerance cell_size_tol (parameter),
which defaults to 0.05. If this tolerance is exceeded, the cell
subdivision is changed on the fly.

<P><LI><B> npt_axial </B><P>
Constant pressure, constant temperature ensemble, 
with volume rescaling along each axis independently.
This works only for <B>orthogonal boxes</B> correctly. 
Works the same way as npt_iso, with the same parameters, except that
the three axial pressures can be specified separately. 

<P><LI><B> mik </B><P>
Microconvergence integrator. After each step, the velocity component
"uphill" in the potential landscape is reset to zero. No particular
parameter is needed, except perhaps the initial temperature, if not 
all atoms have their velocities given in the configuration file.

<A NAME="mikshear">
<P><LI><B>mikshear</B><P> </A> This ensemble no longer exists. Its 
functionality has been integrated into the pull ensemble.

<P><LI><B> frac </B><P>
Fracture simulation with stadium damping. Anyone know how this works?
What do the parameters mean? 

<P><LI><B> hom </B><P>
The sample is sheared in y-direction using a homogeneous displacement
field depending on the x-coordinate of the particle. The parameter
<TT>shear_max</TT> must be specified. This is done
every <TT>hom_interval</TT><SUP>th</SUP> step.<P>
The displacement is scaled with the maximum value of the x-coordinates
of all particles. The latter is computed before each shear step. Thus
atoms with x=0 are not shifted, atoms with maximum x are shifted by
<TT>shear_max</TT>.<P>
Additionally the sample can be isotropically expanded every
<TT>hom_interval</TT><SUP>th</SUP> step.<P>
The rate of expansion is given by the parameter
<TT>expansion</TT>. The box lengths are updated automatically.
<B>Known bugs:</B>Neither the cells are fixed nor the atoms are
redistributed after an expansion. So this should not work at all.

<P><LI><B> pull </B><P>
This is no longer an ensemble. Choose an appropriate ensemble (for
example mik for simulations with repeated shifts and relaxation between
them.
<P>
A border strip (perpendicular to the x-axis) 
of width <TT>strip_width</TT> is fixed and moved. The parameter
<TT>strip_shift</TT> (a vector) specifies this motion.
Depending on the shift vector, one can perform shear deformations 
(shift vector perpendicular to the x-axis) as well as compressions and
dilatations of the sample (shift vector parallel to the x-axis and any
combination of these two.
<P>
In a pull step, the fixed atoms are rigidly moved by the vector
<TT>strip_shift</TT>. After the simulation is finished, all atoms become
mobile again. A shear step is only performed if either
<UL>
<LI>the total kinetic energy of the sample drops below a threshold
value <TT>ekin_threshold</TT> or
<LI>the number of time steps between two successing shear/pull
deformations exceeds the value <TT>maxdnoshsteps</TT>.
</UL>
<STRONG>This is new within the PULL ensemble. If
<TT>ekin_threshold</TT> is set a very high value and
<TT>maxdnoshsteps</TT> is set to zero a shear/pull deformation will be
performed in each time step. As these are the initialization values,
old-style PULL simulations should not change their behaviour.</STRONG>
<P>
As automatic generation of samples may lead to atoms with coordinates
close to zero (which would become negative after several shear steps) 
it is possible to apply an initial shift to the sample. For this the
flag <TT>initial_shift</TT> must be set to 1, and the vector
<TT>ins</TT> must be set to the desired value.

<P><LI><B> mc </B><P>
The Monte Carlo integrator attempts to make random jumps of mean 
length <TT>mc_len</TT> (parameter). The steps are accepted with the 
Metropolis probability min(1,exp(-beta*delta_E), where delta_E is 
the energy difference involved. The inverse temperature beta is
selected with the parameter <TT>mc_beta</TT>. The seed of the random 
number generator can be selected with the parameter <TT>mc_seed</TT>.
<P>
<B>Known bugs:</B> The Monte Carlo integrator has been implemented 
only for serial execution. Since it is not faster than MD integrators,
it does not seem very useful. 

</UL>

<P>
<A HREF="imd.html">Back to IMD User's Guide</A> 

</BODY>
</HTML>